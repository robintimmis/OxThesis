\begin{savequote}[8cm]
\textlatin{Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit...}

There is no one who loves pain itself, who seeks after it and wants to have it, simply because it is pain...
  \qauthor{--- Cicero's \textit{de Finibus Bonorum et Malorum}}
\end{savequote}

\chapter{\label{ch:1-intro}Introduction} 

\minitoc


%{A plan}
%Actually the very first thing to say will be the stuff about light i think, about diagnostic tools essentially always being about controlling the various properties of light (ie electromagnetic waves)

%sections to include
%start with the laser and our entrance into the multi-petawatt regime with no signs of stopping - ref 40 in alex savin thesis - it looks like that is saying huge growth in laser power check that and maybe write in thesis but don't include the figure. Also include description of CPA and OPCPA
%what is a plasma
%modelling plasma with PIC codes
%intense lasers and absorption mechanisms?? yes for sure but dont do all just those just below ZVP
%simulation units and similarity parameter
%Frames of reference - lab, sim, ablating front sruface of plasma

%what is the story? Based on first section by Alex after the abstract
%Plasma is ubiquitous in our known universe and plasma provides us huge opportunities as a tool to improve our lives
%(From chen) what we can see in the sky is a result of that stuff being in the plasma state.
%Lasers can do so much now and are only getting more powerful all the time thanks to CPA and since developments (discuss)
%Simulataneously our ability to understand the physics has been aided by an explosion in computing power (peter HEDP paper)
%In this thesis we discuss some of the opportunities that relativistic laser plasma physics offers us with solid density targets - note that note about solids v gases at this point. 
%Perhaps even before the debye length, define what we mean by the temperature of the plasma??

%An unused statement about ion immobility
%Assume for now that the ion-electron mass ratio is infinite, that is to say the ions are approximately immobile for the timescales under consideration, generally true for a fair few relativistic laser pulse cycles (In later sections the mobility of plasma ions will prove very important but for now this is ignored.).
% I should also discuss ionisation and laser surface plasma interaction?/


\section{High-energy-density physics}
We sit on the verge of the exa-scale revolution both in terms of computing \cite{kotheExascaleComputingUnited2019} and laser power. With rapid adoption of the pioneering advancements of Chirped Pulse Amplification (CPA) by Strickland and Mourou \cite{stricklandCompressionAmplifiedChirped1985} and of Optical Parametric Chirped Pulse Amplification \cite{rossOpticalParametricChirped2000}, multi-petawatt facilities have now been commissioned and built across the globe and plans for sub-exawatt facilities are underway. Figure \ref{fig:intro_lasersystems} details the parameter space accessible by current and proposed facilities \cite{stricklandCompressionAmplifiedChirped1985, fourmauxPedestalCleaningHigh2011, wang085PWLaser2017, tiscarenoOhioStateUniversity2020, sung42PW202017, rossGenerationTerawattPulses2000, yangMultiterawattLaserSystem2002, witte2006source, stoecklHighEnergyPetawattProject2006, lozhkarevCompact56Petawatt2007, herrmannGenerationSubthreecycle162009, andriukaitis90GWPeak2011, zhaoGeneration120GW2013, hoppsOverviewLaserSystems2013, hoppsOverviewLaserSystems2013, thire10MJ5cycle2015, yinHighefficiencyOpticalParametric2016, galesExtremeLightInfrastructure2018, OMEGAFacility, renCompactDoublepassRaman2008, lanciaExperimentalEvidenceShort2010, lanciaSignaturesSelfSimilarRegime2016, marquesJouleLevelHighEfficiencyEnergy2019, thebergeTunableUltrashortLaser2006, trushinSub10fsSupercontinuumRadiation2007, ohIntenseTerahertzGeneration2013, horioGenerationSub17Fs2014, takahashiGeneration10uJCoherent2002, goulielmakisSingleCycleNonlinearOptics2008, skantzakisCoherentContinuumExtreme2009, ferrariHighenergyIsolatedAttosecond2010, takahashiAttosecondNonlinearOptics2013, popmintchevUltravioletSurpriseEfficient2015, nomuraAttosecondPhaseLocking2009, bierbachGeneration10Relativistic2012, heisslerMultimJHarmonicEmission2015, yeungExperimentalObservationAttosecond2017, jahnIntenseIsolatedAttosecond2019, rusEfficientHighbrightnessSoftxray1997, sebbanFullCharacterizationHighgain2000, rusMultimillijouleHighlyCoherent2002, zeitounHighintensityHighlyCoherent2004, wangHighBrightnessInjectionSeededSoftXRayLaser2006, rohringerAtomicInnershellXray2012, ayvazyanFirstOperationFreeelectron2006, ackermannOperationFreeelectronLaser2007, emmaFirstLasingOperation2010, FlashFreeElectronLaser, FlashFreeElectronLaser, FELIXLaboratoryOverview, FELIXLaboratoryOverview, FELIXLaboratoryOverview, kneipObservationSynchrotronRadiation2008, kneipBrightSpatiallyCoherent2010, juEnhancementXraysGenerated2012, chenBrightBetatronXray2013, wangQuasimonoenergeticLaserplasmaAcceleration2013, coleLaserwakefieldAcceleratorsHard2015, wenzQuantitativeXrayPhasecontrast2015, taphuocAllopticalComptonGammaray2012, chenMeVEnergyRaysInverse2013, tsaiCompactTunableCompton2015, polyanskiyPicosecondPulseAmplification2011, haberbergerFifteenTerawattPicosecond2010, glowniaAmplification193nmFemtosecond1992, kandoEnhancementPhotonNumber2009, obenschainHighenergyKryptonFluoride2015, trinesSimulationsEfficientRaman2011, trinesSimulationsEfficientRaman2011, kawanakaConceptualDesignSubexawatt2016, tajimaMarriage20keVSuperconducting2018}, clearly, there is no indication of wavering interest or support for the field of \ac{HED} physics. 
% TODO: \usepackage{graphicx} required
\begin{figure}
	\centering
	\includegraphics[width=\linewidth]{figures/intro/laser_systems}
	\caption[Laser systems across the globe, both commissioned and theorised.]{A by no means exhaustive plot of laser systems across the globe, both commissioned and theorised \cite{stricklandCompressionAmplifiedChirped1985, fourmauxPedestalCleaningHigh2011, wang085PWLaser2017, tiscarenoOhioStateUniversity2020, sung42PW202017, rossGenerationTerawattPulses2000, yangMultiterawattLaserSystem2002, witte2006source, stoecklHighEnergyPetawattProject2006, lozhkarevCompact56Petawatt2007, herrmannGenerationSubthreecycle162009, andriukaitis90GWPeak2011, zhaoGeneration120GW2013, hoppsOverviewLaserSystems2013, hoppsOverviewLaserSystems2013, thire10MJ5cycle2015, yinHighefficiencyOpticalParametric2016, galesExtremeLightInfrastructure2018, OMEGAFacility, renCompactDoublepassRaman2008, lanciaExperimentalEvidenceShort2010, lanciaSignaturesSelfSimilarRegime2016, marquesJouleLevelHighEfficiencyEnergy2019, thebergeTunableUltrashortLaser2006, trushinSub10fsSupercontinuumRadiation2007, ohIntenseTerahertzGeneration2013, horioGenerationSub17Fs2014, takahashiGeneration10uJCoherent2002, goulielmakisSingleCycleNonlinearOptics2008, skantzakisCoherentContinuumExtreme2009, ferrariHighenergyIsolatedAttosecond2010, takahashiAttosecondNonlinearOptics2013, popmintchevUltravioletSurpriseEfficient2015, nomuraAttosecondPhaseLocking2009, bierbachGeneration10Relativistic2012, heisslerMultimJHarmonicEmission2015, yeungExperimentalObservationAttosecond2017, jahnIntenseIsolatedAttosecond2019, rusEfficientHighbrightnessSoftxray1997, sebbanFullCharacterizationHighgain2000, rusMultimillijouleHighlyCoherent2002, zeitounHighintensityHighlyCoherent2004, wangHighBrightnessInjectionSeededSoftXRayLaser2006, rohringerAtomicInnershellXray2012, ayvazyanFirstOperationFreeelectron2006, ackermannOperationFreeelectronLaser2007, emmaFirstLasingOperation2010, FlashFreeElectronLaser, FlashFreeElectronLaser, FELIXLaboratoryOverview, FELIXLaboratoryOverview, FELIXLaboratoryOverview, kneipObservationSynchrotronRadiation2008, kneipBrightSpatiallyCoherent2010, juEnhancementXraysGenerated2012, chenBrightBetatronXray2013, wangQuasimonoenergeticLaserplasmaAcceleration2013, coleLaserwakefieldAcceleratorsHard2015, wenzQuantitativeXrayPhasecontrast2015, taphuocAllopticalComptonGammaray2012, chenMeVEnergyRaysInverse2013, tsaiCompactTunableCompton2015, polyanskiyPicosecondPulseAmplification2011, haberbergerFifteenTerawattPicosecond2010, glowniaAmplification193nmFemtosecond1992, kandoEnhancementPhotonNumber2009, obenschainHighenergyKryptonFluoride2015, trinesSimulationsEfficientRaman2011, trinesSimulationsEfficientRaman2011, kawanakaConceptualDesignSubexawatt2016, tajimaMarriage20keVSuperconducting2018, NetElectricityConsumption, umstadterRelativisticLaserPlasma2003} to provide an overview of the parameter space currently and soon to be accessible. The experimental result obtained at the ORION laser facility \cite{hoppsOverviewLaserSystems2013} is presented, and will be discussed in detail in chapter \ref{ch:3-ORION}. The dashed orange line is the accompanying theoretical prediction. The red dashed line indicates the parameter space accessible via the methods discussed in this thesis when coupled with a sub-etawatt Raman amplified laser beam. Such a beam would provide intensities in the water window many orders of magnitude beyond that currently accessible in state-of-the-art facilities. }

	\label{fig:intro_lasersystems}
\end{figure}

\ac{HED} physics is the laboratory study of the behaviour of matter with a pressure above \qty{10}{GPa}, approximately one million atmospheres and containing free electrons not confined to a solid state \cite{drakeFocusHighEnergy2014}, typically in the plasma state of matter. \ac{HED} conditions are found for a vast range of  densities and temperatures (from zero to a million million Kelvin) operating in both the quantum and relativistic realms. The applications are equally diverse, including but not limited to inertial confinement fusion, particle acceleration for scientific or medical purposes and light sources for diagnostic tools. Ubiquitous in the natural universe, beyond our solar system, all that can be observed in the sky is radiation emitted from \ac{HED} plasmas \cite{chen}.

This thesis concerns itself with a specific interaction, that of a high-power short-pulse laser incident on a flat solid target. Through the process discussed in this thesis, using state-of-the-art 10 PW laser facilities such as \cite{galesExtremeLightInfrastructure2018}, electron bunches and light pulse of unprecedented charge and brightness can be produced, both with attosecond duration, thus uncovering new avenues for attosecond resolution diagnostics and to access the Schwinger limit. Seemingly counter-intuitively, as the laser power increases, via relativistic effects and for certain conditions, greater coherency in the electron dynamics can be observed and the signals amplified. The red dashed line of figure \ref{fig:intro_lasersystems} could be accessed using next generation sub-etawatt facilities. Before delving into this fascinating phenomenon, the remainder of this chapter will provide some of the relevant background information. Chapter \ref{ch:2-zvp} introduces the Zero Vector Potential of attosecond absorption in this laser-solid interaction. The following chapter discusses the associated process of Surface High Harmonic Generation and the results of a recent experiment at the ORION laser facility where the absolute intensity of individual X-ray harmonics was measured and compared to the theory.

\section{Electromagnetism fundamentals}
The spatio-temporal propagation of electric $\mathbf{E}(t,\mathbf{x})$ and magnetic $\mathbf{B}(t,\mathbf{x})$ fields must satisfy Maxwell's equations \cite{chenIntroductionPlasmaPhysics2016}
\begin{subequations}
	\label{eq:intro-maxwell}
	\begin{align}
		\nabla \cdot \mathbf{B} &= 0, \label{eq:intro-B0} \\
		\nabla \cdot \mathbf{E} &= \frac{\rho}{\epsilon_0},\label{eq:intro-E0} \\
		\nabla \times \mathbf{B} &= \mu_0 \mathbf{J} + \mu_0 \epsilon_0 \partial_t \mathbf{E},\label{eq:intro-B1} \\
		\nabla \times \mathbf{E} &=-\partial_t \mathbf{B}. \label{eq:intro-E1}
	\end{align}
\end{subequations}
Here, $\epsilon_0 = \qty{8.85e-12}{F.m^{-1}}$ and $\mu_0 = \qty{1.26e-6}{N.A^{-2}}$ are the vacuum permittivity and permeability respectively and $\rho(t,\mathbf{x})$ and $\mathbf{J}(t,\mathbf{x})$ the total charge and current densities of charged particles present. 

A particle with charge $q$ and velocity $\mathbf{v}$ in the presence of electromagnetic fields experiences the Lorentz force,
\begin{equation}\label{eq:intro-Lorentz_force}
	\mathbf{F}_\mathrm{L} = q(\mathbf{E} + \mathbf{v} \times \mathbf{B}).
\end{equation}

The electromagnetic fields can be obtained from the scalar, $\phi$, and vector, $\mathbf{A}$, potentials as  \cite{steaneRelativityMadeRelatively2012}
\begin{equation}
	\mathbf{E} = -\nabla \phi - \partial_t \mathbf{A},
\end{equation}
\begin{equation}
	\mathbf{B} = \nabla \times \mathbf{A}.
\end{equation}

\section{\label{sec:plasma_def}The definition of a plasma}
As outlined in F. Chen's definitive textbook `Introduction to Plasma Physics and Controlled Fusion' \cite{chenIntroductionPlasmaPhysics2016}, a plasma must fulfil three criteria, namely,

\begin{enumerate}
	\item Ionisation: a plasma must consist of both charged and neutral particles, of course this alone cannot define a plasma, any gas will contain some degree of ionisation, however, with reference to figure \ref{fig:intro_lasersystems}, clearly, modern high power laser systems will instantaneously fully ionise a target upon incidence;
	\item Quasineutrality: while locally there can be (often extreme) electromagnetic forces and charge concentrations at work, over the length scales of the plasma, such forces are screened out and the plasma bulk remains net neutral in charge;
	\item Collective behaviour: unlike in a gas, where collisions will dominate the dynamics, the particles in a plasma generate electromagnetic fields that interact at a distance and thus a particle's motion depends not only on its immediate vicinity but on the surrounding plasma conditions, indeed often it is the so-called `collisionless' plasmas where collisions can be safely neglected that are of most interest, as is the focus of this thesis.
\end{enumerate}

These conditions can be quantitatively described by the Debye length, the plasma parameter and the plasma frequency as laid out in the following sections.

\subsection{\label{sec:debye_length}The Debye length}
The Debye length describes the extent to which a plasma can shield electromagnetic fields within and so remain quasineutral. Consider an infinitely extending plasma with a test charge placed at some point, then what would be the scalar potential $\phi(\mathbf{x})$ around it? If the plasma had no kinetic energy, the charged particles would arrange themself immediately ajacent to the test charge and once this equilibrium state was reached there would be no electromagnetic fields present. More realistically, the plasma will have some temperature, likely a very large temperature and so some particles will be able to escape the potential of the test charge and thus leak electromagnetic fields into the plasma bulk. Poisson's equation (equation \ref{eq:intro-E0} in the static case) reads
\begin{equation}\label{eq:poisson}
	\epsilon_0\nabla^2\phi = -e(Zn_\mathrm{i} - n_\mathrm{e}),
\end{equation}
where $\epsilon_0 = \qty{8.854e-12}{F.m^{-1}}$ is the permittivity of free space, $e = \qty{1.602e-19}{C}$ is the charge of an electron, $Z$ is the plasma ion charge in units of $e$ and $n_\mathrm{i}$ and $n_\mathrm{e}$ are the number densities of plasma ions and electrons.

Since the electrons are significantly more mobile than the ions due to their lower mass, it is in general the electrons and not the ions that respond to the test charge and the ions can be assumed to provide a constant background of positive charge density.
If the number density of electrons follows a Boltzmann temperature distribution in the presence of a potential energy $-e\phi$, then
\begin{equation}\label{eq:nj_boltzmann}
	n_\mathrm{e}= n_{\mathrm{e},0}e^{e\phi/KT_\mathrm{e}},
\end{equation}
where $n_{\mathrm{e},0}$ is the electron number density far from the test charge, $n_\mathrm{i} = n_{\mathrm{e},0}/Z$, $K = \qty{1.38e-23}{J.K^{-1}}$ is the Boltzmann constant and $T_\mathrm{e}$ is the electron temperature in Kelvin. Note that in plasmas it is very common for different species to have differing temperatures depending on the mechanism for energy absorption and the timescales for collisions compared to the timescale of the study.

Substituting equation \ref{eq:nj_boltzmann} into equation \ref{eq:poisson} and Taylor expanding the exponential term in the limit that the plasma is weakly coupled ($e\phi << KT_\mathrm{e}$), 
\begin{equation}\label{eq:poisson_debye2}
	\nabla^2\phi = \frac{\phi}{\lambda_\mathrm{D}^2},
\end{equation}
where
\begin{equation}\label{eq:debye}
	\lambda_\mathrm{D} \equiv \sqrt{\frac{\epsilon_0KT_\mathrm{e}}{n_\mathrm{e}e^2}},
\end{equation}
is the \textit{Debye length} and describes the thickness of the charge sheath surrounding the test charge. For quasineutrality to hold for the plasma bulk, its spatial dimensions, $L$, must extend beyond a few Debye lengths, \textit{i.e.}
\begin{equation}
	L \gg \lambda_D.
\end{equation}

\subsection{\label{sec:plasma_parameter}The plasma parameter}
In order for the derivation of section \ref{sec:debye_length} to be statistically valid, there must be a large number of charged particles within the shielding sheath. The number of particles within the \textit{Debye sphere} is
\begin{equation}\label{eq:plasma_parameter}
	N_\mathrm{D} = \frac{4}{3}\pi\lambda_\mathrm{D}^3n,
\end{equation}
where, $N_\mathrm{D}$ is the \textit{plasma parameter}. Note that, as discussed above, in most cases it is most suitable to choose the number density $n$ to be the number density of electrons, $n_\mathrm{e}$. To ensure the plasma is suitably ionised (criterion 1) and that the plasma engages in collective behaviour (criterion 3),
\begin{equation}\label{eq:plasma_parameter_condition}
	N_\mathrm{D} \ggg 1.
\end{equation}
\subsection{\label{sec:plasma_frequency}Collisionality and the plasma frequency}
Collective behaviour not only depends on the ability for large numbers of particles to interact via electromagnetic forces but also that these forces dominate over collisions in describing particle trajectories. Taking $\omega$ as the typical frequency of plasma oscillations and $\tau$ as the average time between collisions, for a plasma (as opposed to a gas)
\begin{equation}\label{eq:plasma_frequency_condition}
	\omega\tau > 1
\end{equation}
is required. It now remains to determine what is the typical frequency of collisions in a given plasma. While the types of plasma waves and their associated frequencies of oscillation are multitudinous, the characteristic frequency, the \textit{plasma frequency}, $\omega_\mathrm{p}$, is the most straightforward. It describes the response of electrons to charge imbalances within an infinite uniform plasma at rest in the absence of magnetic fields or temperature fluctuations. As noted in section \ref{sec:debye_length}, the ions provide a constant background of positive charge.

Consider an semi-infinite plasma existing for $x>0$, with electron density $n_\mathrm{e}$ and ion density $n_\mathrm{e}/Z$ of charge state $Z$\footnote{This description has direct relevance to the Zero Vector Potential mechanism which will be made clear in chapter \ref{ch:2-zvp}.}. Suppose the electron fluid is displaced by some perfectly isotropic force into the plasma bulk a distance $(\Delta x) \hat{\mathbf{x}}$ as in figure \ref{fig:introplasmafrequency}. 
\begin{figure}
	\centering
	\includegraphics[width=0.7\linewidth]{figures/intro/intro_plasma_frequency}
	\caption[Diagram to illustrate the derivation of the plasma frequency.]{The electrons of a semi-infinite plasma are displaced inwards by some external force leaving in their wake an uncompensated space charge of `immobile' positive ions. By constructing a Gaussian surface along the dashed line, using Gauss' Law, the electric field associated with the positive space charge can be calculated.}
	\label{fig:introplasmafrequency}
\end{figure}
The total charge of displaced electrons within a surface area of $\sigma$ is 
\begin{equation}\label{eq:intro_Q}
	Q = -en_\mathrm{e}\sigma\Delta x.
\end{equation}
Applying the integral from of Gauss' law (from equation \ref{eq:intro-E0}) to the surface detailed in figure \ref{fig:introplasmafrequency}, the uncompensated charge leads to 
\begin{equation}\label{eq:intro_E}
	-\sigma E\hat{\mathbf{x}}= \frac{Q}{\epsilon_0}\hat{\mathbf{x}} = -\frac{en_\mathrm{e}\sigma\Delta x}{\epsilon_0}\hat{\mathbf{x}}
\end{equation}
at the electron surface. By the Lorentz force, equation \ref{eq:intro-Lorentz_force}, the displaced electrons will experience a restoring force, $-eE\hat{\mathbf{x}}$, perpendicular to the surface due to the electron-ion charge imbalance. The equation of motion for electrons on that surface is therefore
\begin{equation}\label{eq:intro_sho}
	m_e\frac{\mathrm{d}^2\Delta x}{\mathrm{d}t^2} = -eE = -\frac{e^2n_\mathrm{e}}{\epsilon_0}\Delta x.
\end{equation}
Equation \ref{eq:intro_sho} clearly describes a simple harmonic oscillator with a characteristic frequency given by the plasma frequency,
\begin{equation}
	\omega_\mathrm{p} = \sqrt{\frac{e^2n_\mathrm{e}}{m_\mathrm{e} \epsilon_0}}.
\end{equation}

\section{The Lawson-Woodward theorem}\label{sec:intro-lawson_woodward}
The Lawson-Woodward theorem states that there can be no net electron energy gain using laser fields \cite{esareyPhysicsLaserdrivenPlasmabased2009}, quite at odds with one of the primary aims of this thesis, that is, the acceleration of electrons. There are, however, several conditions that must be met, namely,
\begin{enumerate}
	\item The interaction region is infinite;
	\item The interaction  occurs in a vacuum;
	\item The electron is ultra-relativistic ($v\approx c$) along the acceleration gradient;
	\item No electro- or magnetostatic fields are present;
	\item Non-linear effects are neglected.
\end{enumerate}
Several of these will be applicable to the various accelerations of electrons considered. It is this final condition that is most damning to the application of the theorem. Throughout this thesis the ultra-relativistic laser pulses under consideration ensure non-linear effects cannot be neglected. It is indeed such non-linearities that are of most interest.


\section{Laser-solid density plasma linear interaction}\label{sec:intro-lasersolidplasma_linear}
Consider small transverse electromagnetic waves propagating through a plasma. Linearising equation \ref{eq:intro-Lorentz_force} for a single plasma electron by assuming only small field variations and thus small velocity variation,
\begin{equation}\label{eq:intro-EOM_linear}
	m_\mathrm{e}  \dot{\mathbf{v}}_\mathrm{e} = -e\mathbf{E}.
\end{equation}
Combining the time derivative of equation \ref{eq:intro-B1} and the curl of equation \ref{eq:intro-E1},
\begin{equation}
	\nabla\times\nabla \times \mathbf{E}= - \mu_0 \dot{\mathbf{J} }- \mu_0\epsilon_0 \ddot{\mathbf{E}}.
\end{equation}
Considering only fast oscillations such that ions are effectively immobile,
\begin{equation}
	\mathbf{J} = - n_\mathrm{e} e\mathbf{v}_\mathrm{e}
\end{equation}
and using the identity $\nabla\times\nabla \times \mathbf{E} = \nabla(\nabla\cdot \mathbf{E}) - \nabla^2\mathbf{E}$,
\begin{equation}
	\nabla(\nabla\cdot \mathbf{E}) - \nabla^2\mathbf{E} = -\frac{\mu_0 n_\mathrm{e} e^2}{m_\mathrm{e}} \mathbf{E}  - \mu_0 \epsilon_0 \ddot{\mathbf{E}}.
\end{equation} 
Assuming plane wave solutions of the form
\begin{equation}
	\mathbf{E} = \mathbf{E_0}e^{i(\mathbf{k}\cdot \mathbf{x}-\omega t)},
\end{equation}
where $\mathbf{k}$ is the wave-vector and $\omega$ the frequency of oscillations and noting the waves are transverse $\mathbf{k}\cdot \mathbf{E} = 0$,
\begin{equation}
	|\mathbf{k}|^2 \mathbf{E} = -\frac{\mu_0 n_\mathrm{e} e^2}{m_\mathrm{e}}\mathbf{E} + \mu_0\epsilon_0\omega^2\mathbf{E}
\end{equation}
and hence the dispersion relation for electromagnetic waves propagating in a plasma is
\begin{equation}\label{eq:intro-EM_dispersion}
	\omega^2  = c^2|\mathbf{k}|^2  + \omega_\mathrm{p}^2.
\end{equation}
Equation \ref{eq:intro-EM_dispersion} exhibits a \textit{cutoff} dependent on the plasma density via $\omega_\mathrm{p}$. The \textit{critical density}, $n_\mathrm{c}$, is defined as the density above which a laser pulse of frequency $\omega_\mathrm{L}$ cannot propagate through a plasma. This occurs for $\omega_\mathrm{L} = \omega_\mathrm{p}$, thus,
\begin{equation}
	n_\mathrm{c} = \frac{m_\mathrm{e}\epsilon_0 \omega_\mathrm{L}^2}{e^2}.
\end{equation}
As the plane wave has a spatial dependence $\sim \exp{(\mathbf{k}\cdot\mathbf{x})}$, if $n_\mathrm{e} > n_\mathrm{c}$, $\mathbf{k}$ is imaginary and the wave no longer propagates through the plasma and instead exponentially attenuates over a skin depth,
\begin{equation}
	\delta = \frac{1}{|\mathbf{k}|} = \frac{c}{\sqrt{\omega_\mathrm{p}^2 - \omega_\mathrm{L}^2}}
\end{equation}
and is reflected. For typical high power lasers with wavelengths in the visible or near-infrared, fully ionised solids tend to have densities well above the critical density and thus 

\section{Relativity}
Modern high-power lasers operate in the domain of relativistic mechanics and in general interactions are highly non-linear. It is useful to introduce some of the basic principles of relativity. Note that while there has been growing interest in the curvature of spacetime by relativistic lasers \cite{atongaGravitationalWavesHighpower2023}, this effect remains undetectable at present. Thus, throughout this thesis the inner product of 4-tensors is defined using the Minkowski Metric \cite{steaneRelativityMadeRelatively2012}. 

Many useful quantities can be arranged into contravariant four-vectors that undergo a Lorentz transformation for a change of frame of reference \cite{steaneRelativityMadeRelatively2012}, specifically, 
\begin{equation}
	\mathbf{A}'^\mu = \Lambda^\mu_\nu \mathbf{A}^\mu,
\end{equation}
where $\Lambda^\mu_\nu$ is the appropriate Lorentz transformation, and primed symbols typically denote boosted frames of reference. Without loss of generality, the coordinate system can be defined such that the boosted frame travels along the $\mathbf{x}$-axis with respect to the initial frame. Thus, the Lorentz transformation is defined
\begin{equation}\label{eq:zvp_lorentz}
	\Lambda^\mu_\nu = \begin{pmatrix}
		\gamma & -\beta\gamma & 0 & 0\\
		-\beta\gamma & \gamma & 0 & 0\\
		0 & 0& 1 & 0\\
		0 & 0 & 0 & 1
	\end{pmatrix}.
\end{equation}
Generally, a \textit{beta factor} is a normalised speed or velocity of an object,
\begin{equation}
	\beta = \frac{v}{c}, 
\end{equation}
here it refers to the frame velocity and its associated Lorentz or \textit{gamma factor} is
\begin{equation}
	\gamma = \frac{1}{\sqrt{1-\beta^2}}.
\end{equation}
Four-vectors relevant this thesis are listed in table \ref{tab:intro-four-vectors}.
%Many useful quantities can be arranged into contravariant four-vectors that undergo a Lorentz transformation for a change of frame of reference, those relevant this thesis are: the four-displacement
%\begin{equation}
%	\mathbf{X}^\mu = (ct, \mathbf{x}),
%\end{equation}
%the four-potential
%\begin{equation}
	%\mathbf{A}^\mu = \left(\frac{\phi}{c}, \mathbf{A}\right),
%\end{equation}
%the four-current density
%\begin{equation}
%	\mathbf{J}^\mu = (c\rho,\mathbf{J}),
%\end{equation}
%the four-wave vector
%\begin{equation}
%	\mathbf{K}^\mu = \left(\frac{\omega}{c}, \mathbf{k}\right)
%\end{equation}
%and the four-momentum of a particle
%\begin{equation}
%	\mathbf{P}^\mu = \left(\frac{U}{c}, \mathbf{p}\right),
%\end{equation}
%where $U = \gamma m c^2$ is the particle energy and $\mathbf{p} = \gamma m\mathbf{v}$ its three-momentum.
\begin{table}
	\begin{center}
		\begin{tabular}{llll}
			 \hline \hline
			Symbol & Name & Components & Invariant \\
			\hline
			$\mathbf{X}^\mu$& 4-displacement & $(ct, \mathbf{x})$ & $-c^2\tau^2$  \\
			$\mathbf{A}^\mu$&4-potential  & $(\phi/c, \mathbf{A})$  &  \\
			$\mathbf{J}^\mu$& 4-current density & $(c\rho,\mathbf{J})$ & $-c^2\rho_0^2$ \\
			$\mathbf{K}^\mu$& 4-wave vector &$(\omega/c, \mathbf{K})$  &  \\
			$\mathbf{P}^\mu$& 4-momentum &  $(U/c, \mathbf{p})$& $-m^2c^2$ \\
			\hline \hline
		\end{tabular}
\caption{\label{tab:intro-four-vectors} Four-vectors of relevance to this thesis. New parameters are the proper time, $\tau$, the proper charge density, $\rho_0$, energy, $U = \gamma m c^2$, three-momentum, $p = \gamma m\mathbf{v}$.}
\end{center}
\end{table}
Transformations of electromagnetic fields under reference frame boosts are given in appendix \ref{sec:app_lorentzEM} and Maxwell's equations are Lorentz covariant.

Focusing now on the 4-potential $\mathbf{A}^\mu$, choosing the Lorenz gauge,
\begin{equation}
	 \partial_\mu \mathbf{A}^\mu = \nabla \cdot \mathbf{A} + \frac{1}{c^2}\partial_t \phi = 0,
\end{equation}
then Maxwell's equations can be written
\begin{equation}\label{eq:intro-wave_equation}
	\partial_\nu \partial^\nu \mathbf{A}^\mu = -\frac{1}{c^2\epsilon_0}\mathbf{J}^\mu.
\end{equation}
Equation \ref{eq:intro-wave_equation} can then be solved to yield 
\begin{equation}
	\mathbf{A}(\mathbf{x},t) = \frac{\mu_0}{4\pi} \int \frac{\mathbf{J}(\mathbf{x'},t_\mathrm{a})}{|\mathbf{x}-\mathbf{x}'|} \mathrm{d}^3\mathbf{x}',
\end{equation}
where $t_\mathrm{a} = t- |\mathbf{x}-\mathbf{x}'|/c$ is the advanced time.

\subsection{Relativistic similarity theory}
Relativistic effects occur. Intruce the normalised a0, then introduce the S



The descriptor `Relativistic' is applied liberally in this thesis. When applied to electromagnetic fields or laser pulses it refers to 
\begin{equation}
	a_0 \ge 1.
\end{equation}
When applied to particles, their Lorentz factors are
\begin{equation}
	\gamma = \frac{1}{\sqrt{1-\beta^2}} \ge 2,
\end{equation}
corresponding to a speed, $u \ge 0.87 c$. A relativistic laser pulse will accelerate electrons to relativistic velocities in a fraction of a laser pulse cycle. Consider an electron in the presence of a uniform electric field of magnitude $a_0 = 100$, an intensity accessible by current state of the art laser facilities. The work done on that particle by the field is 
\begin{equation}
	T = (\gamma -1)m_\mathrm{e}c^2 = \int \mathbf{E}\cdot \mathrm{d} \mathbf{x},
\end{equation}
The field will accelerate an electron to relativistic velocities in a distance less than 1 \% of a corresponding laser pulse wavelength.

\subsection{Conservation of generalised transverse momentum}\label{sec:intro_conservation-generalised-mometum}
Consider a holonomic system of $N$ relativistic particles under the influence of electromagnetic forces. A particle $j$ with charge $e_j$ and mass $m_j$ experiences a scalar potential,
\begin{equation}
		V_{j} = e_j(\phi - \mathbf{A} \cdot \mathbf{v}_{j})
\end{equation}
and hence the system is described by the Lagrangian \cite{goldsteinClassicalMechanics2013}
\begin{equation}
	\mathcal{L} = \sum^N_{j=1}\left( - m_jc^2\sqrt{1-\beta^2_\mathrm{j}} - e_j(\phi - \mathbf{A} \cdot \mathbf{v}_j) \right),
\end{equation}
The generalised momentum corresponding to coordinate $x_j$ is
\begin{equation}
	p_{j,x} = \frac{\partial L}{\partial \dot{x}_j} = m_j\dot{x}_j + e_jA_x,
\end{equation}
thus, the generalised momentum describes both the linear mechanical momentum and the momentum of the electromagnetic field. Via Noether's theorem, if $L$ is independent of $x_j$, \textit{i.e.} spatially homogeneous along $x$ for particle $j$, then 
\begin{equation}\label{eq:intro-transverse_momentum_differential_equation}
	\dot{p}_{j,x} = 0
\end{equation}
since
\begin{equation}
	\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial L}{\partial \dot{x}_j}\right) = \frac{\partial L}{\partial x_j}.
\end{equation}

Consider a linearly polarised Gaussian laser pulse, with axis of polarisation along $x$ incident on a solid target at rest. Then $A_x$ is approximately constant along $x$ near the beam centre\footcite{Constant relative to the scale of typical electron trajectories in such an interaction.}. Integrating equation \ref{eq:intro-transverse_momentum_conservation_no_initial_momentum} and noting that initially there is no linear or electromagnetic momentum at the target, the generalised transverse momentum conservation equation for an electron in the laser field is
\begin{equation}\label{eq:intro-transverse_momentum_conservation_no_initial_momentum}
	p_\mathrm{T} = eA,
\end{equation}
where $p_\mathrm{T}$ is the electron momentum along the polarisation axis of the laser pulse and $A$ it the laser pulse 3-vector potential amplitude.

Note that this is only valid provided the electron does not radiate along the direction of polarisation as discussed by Sokolov \textit{et al} \cite{sokolovDynamicsEmittingElectrons2009}. The implications of `Radiation Reaction' are discussed in the following section.

\section{QED effects}
We are now at the cusp of \ac{SF-QED} laser-plasma physics. Access to this regime will enable the testing of decades old theoretical predictions. Already Fedeli \textit{et al} have shown in simulations that current PW-class laser facilities can access the regime using an all-optical set up based on laser-solid surface interactions \cite{fedeliProbingStrongfieldQED2020}. The primary two SF-QED phenomena to be accessed are Radiation Reaction and multi-photon Breit-Wheeler electron pair production. Brief introductions to these phenomena are now presented.


\subsection{High-energy photon emission and radiation reaction}
When a charged particle undergoes an acceleration, it emits electromagnetic radiation. If the electromagnetic field is sufficiently strong, \textit{i.e.} approaching the Schwinger Limit in the rest frame of the particle, then a non-neglible fraction of particle momentum can be transferred to the emitted high energy photon via inverse Compton scattering, substantially impacting the dynamics of the accelerated particle. This back reaction is known as Radiation Reaction.



Note for in simulation section: 'The processes discussed in this section bring into play a characteristic length [the classical radius of the electron 

in classical electrodynamics (CED) or the standard Compton wavelength 

in quantum electrodynamics (QED)]. As a result, a simulation will require the user to define the absolute scale of the system by defining the referencangularfrequencySI parameter' '
Also there are a list of assumptions in smilei that I should state in the simulation section and demonstrate they are all fine.

\subsection{Multi-photon Breit-Wheeler pair production}

(This has been written up from smilei but should probs get reference elsewhere??) > check out savin thesis

Multi-photon Breit-Wheeler pair production, also known as non-linear Breit-Wheeler is the decay of a high energy photon, typically produced via \ac{RR}, into an electron-positron pair in the presence of a strong electromagnetic field, explicitely,
\begin{equation}
	\gamma + n\omega \to e^- + e^+.
\end{equation}
The strength of the effect is dependent on the Lorentz invariant photon quantum parameter,
\begin{equation}
	\chi_\gamma = \frac{\gamma_\gamma}{E_\mathrm{s}} \sqrt{(\mathbf{E}_\perp + \mathbf{c}\times \mathbf{B}^2},
\end{equation}
where $E_\mathrm{s} = \qty{1.3e18}{V.m^{-1}}$ is the Schwinger electric field, $\gamma_\gamma = U_\gamma /m_\mathrm{e}c^2$, the normalised photon energy and $\mathbf{E}_\perp$ the electric field perpendicular to the photon propagation direction. Cite Smilei and say, in a constant E-field, the rate of pair production increases rapidly up to $\chi_\gamma \approx 10$ at which point it saturates and slowly reduces.


If the electron radiates all its energy to the photon, for the ZVP mechanism, at the point of emission one finds,
\begin{equation}
	\chi_\gamma = |\mathbf{E}|\frac{1 + \frac{a^2_0}{\bar{n}_\mathrm{e}}}{E_\mathrm{s}} \sqrt{2},
\end{equation}
The chi parameter will change rapidly once the transition to QED ZVP has occured due to the change in scaling.


\section{Simulating the interaction}
Modelling laser-plasma interactions is notoriously challenging; due to the complexity of the many-bodied system and the stochasticity of particle motion, it is frequently impossible to construct models \textit{ab initio}. Instead, hydrodynamic simulation codes such as HYADES \textbf{CITE} and Particle-In-Cell simulation codes such as Smilei \cite{derouillatSmileiCollaborativeOpensource2018}, Osiris\textbf{ \cite{bibid}} and EPOCH are used to construct phenomenological models and to direct experimentation. 

\subsection{Particle-In-Cell codes}

\textbf{Other considerations:(At some point list all the other sources of potential error, including ignoring ionisation, ionisation states, collisions.)}
I think put this in the main intro section. Then start PIC codes with discretisation of the Vlasov-Maxwell system of equations.

\subsubsection{The Vlasov-Maxwell system of equations}
A collisionless and fully ionised plasma is fully described in the kinetic description by the Vlasov-Maxwell system of equations \cite{derouillatSmileiCollaborativeOpensource2018}. Each plasma species, $s$, of particles with mass $m_s$ and charge $q_s$ is described by its distribution function $f_s(t,\mathbf{x},\mathbf{p})$ at time $t$, position $\mathbf{x}$ and momentum $\mathbf{p} = m_s \gamma \mathbf{v}$. The distribution satisfies the Vlasov equation, that is,
\begin{equation}
	(\partial_t + \frac{\mathbf{p}}{m_s\gamma} \cdot \nabla + \mathbf{F}_\mathrm{L} \cdot \nabla_\mathbf{p})f_s = 0,
\end{equation}
where $\mathbf{F}_\mathrm{L}$ is given in equation \ref{eq:intro-Lorentz_force}. The electric $\mathbf{E}(t,\mathbf{x})$ and magnetic $\mathbf{B}(t,\mathbf{x})$ fields that generate the force must satisfy Maxwell's equations(equation \ref{eq:intro-maxwell}).

This self-consistent system of equations describes the dynamics of plasma particles within electromagnetic fields. The particles then modify the fields via their charge and current densities,
\begin{equation}
	\rho(t,\mathbf{x}) = \sum_s q_s \int d^3pf_s(t,\mathbf{x},\mathbf{p}),
\end{equation}
and 
\begin{equation}
	\mathbf{J}(t,\mathbf{x}) = \sum_s q_s \int d^3p\mathbf{v}f_s(t,\mathbf{x},\mathbf{p}),
\end{equation}
respectively.

\subsubsection{Discretisation of the Vlasov-Maxwell equations}
Finding numerical solutions to the Vlasov-Maxwell equations is no straightforward task, there are codes that are capable such as Valis \textbf{**CITE**}, however, the requirement of high resolution in both position and momentum is exceedingly costly and use of such codes are limited in their size, duration and spatial dimensions. A more tractable approach is to discretise the distribution function into $N_s$ `quasi-particles'\footnote{Originally introduced by Langdon and Birdsall as `clouds' \cite{langdonTheoryPlasmaSimulation1970}.} . There are often referred to as `macro-particles' in practice and typically represent a large number of real particles, such that
\begin{equation}
	f_s(t,\mathbf{x},\mathbf{p}) = \sum^{N_s}_{p=1} w_p S(\mathbf{x}-\mathbf{x}_p(t))\delta (\mathbf{p}-\mathbf{p}_p(t)),
\end{equation}
where $w_p$ is the quasi-particle's weight, $\mathbf{x}_p$ and $\mathbf{p}_p$ are its position and momentum respectively, $\delta$ is the Dirac-delta distribution and $S(\mathbf{x})$ the shape-function chosen to represent the quasi-particle. The Vlasov equation is then integrated along the continuous trajectories of the quasi-particles while Maxwell's equations are solved on a discrete spatial grid of `cells'. Such a code is aptly named a `\ac{PIC}' code. A schematic of the PIC code algorithm is presented in figure \ref{fig:intropiccycle-01}. 
% TODO: \usepackage{graphicx} required
\begin{figure}
	\centering
	\includegraphics[width=\linewidth]{figures/intro/intro_PIC_cycle}
	\caption[A schematic of the PIC code loop and the algorithms performed.]{A schematic of the PIC code loop and the algorithms performed from time step, $ts$, from $n$ to $n+1$.}
	\label{fig:intropiccycle-01}
\end{figure}
After initialising particles, Maxwell's equations are solved with the \ac{FDTD} approach \cite{tafloveComputationalElectromagneticsFiniteDifference2005} where electromagnetic fields are discretised the staggered `Yee grid' as represented in figure \ref{fig:introyeegrid}. This ensures 
% TODO: \usepackage{graphicx} required
\begin{figure}
	\centering
	\includegraphics[width=0.7\linewidth]{figures/intro/intro_yee_grid}
	\caption[A representation of the staggered Yee grid for efficient curl calculations.]{A representation of the staggered 3D Yee grid for the cell at $(i\Delta x, j\Delta y, k\Delta z)$ for efficient curl calculations, including the locations where all system properties are defined.}
	\label{fig:introyeegrid}
\end{figure}

HMM Im confused... read langdon maybe and redo this section then?

To ensure space and time centering of the electromagnetic field derivatives in Maxwell's equations, electric and magnetic fields are discretised on the staggered `Yee grid'. Electric fields are defined at integer time steps, $n$ while magnetic fields at half-integeter ($n + 1/2$) time steps. Note, for the particle pusher it is also required that the magnetic fields also be defined at integer steps. Particles are advanced in time using a `leap-frog' scheme, where positions are defined at integer timesteps and momenta at half integer.

Using a momentum and charge conserving scheme (cite Esekipov sheme for charge conservation used by Smilei.).

Well known Boris pusher


\subsubsection{Smilei}
Smilei (for Simulating Matter Irradiated by Light at Extreme Intensities) is a modern collaborative, massively-parallel, fully relativistic and open source plasma physics PIC code and was the main workhorse for this thesis\footnote{At points benchmarks agaist the EPOCH and Osiris PIC codes were performed.}. Produced by M. Grech's team(CHECK THIS) at École Polytechnique \cite{derouillatSmileiCollaborativeOpensource2018}, its recent development was motivated by the rapid advancements of multi-petawatt facilities globally including their local Apollon laser and by the availability of supercomputing power which has `skyrocketed' in recent years \cite{derouillatSmileiCollaborativeOpensource2018}. Indeed, the 3D \ac{PIC} simulations discussed in this thesis required the parallelisation of almost 20 \% of the computing resources available on ARCHER2.


\subsubsection{Reference quantities}
This needs rewording so as not to be the same as paper.

%With the vast range of magnitudes associated with multi-petawatt and femtosecond laser pulses, solid density plasmas, micrometre wavelengths and attosecond bunches, it is much more efficient to convert to dimensionless normalised quantities. The standard four that describe the dynamics of the system \cite{BOUCHARD THESIS??} correspond directly to each of these. The three asso- ciated with the laser are: the temporal parameter, ωLτ, where τ is the pulse duration, the spatial parameter, λL/R, where λL is the wavelength and R the beam width, and the intensity parameter, the normalised vector po- tential, a0 = eEL/(mecωL), where EL is the peak laser electric field strength, and e and me are the charge and mass of an electron.
%For the plasma, the key parameter is the density rel- ative to the critical density, n ̄e = ne/nc, here ne is the electron density and nc = ε0 me ωL2 /e2 is the critical den- sity at which the plasma becomes opaque to the laser electric field, assuming relativistic effects can be ignored.
%Relativistic similarity theory states that the laser- plasma interaction does not depend on n ̄e and a0 inde- pendently but via the relativistic similarity parameter
%S=n ̄e, (1) a0
%essentially accounting for relativistic effects in the over- density of the plasma. Previous work on the ZVP mech- anism has suggested that the ZVP regime is valid for relativistic interactions, a0 > 1, with S ≥ 1. For S < 1, the onset of relativistically self-induced transparency ef- fects [42] renders the model invalid. Equally, for large a0, the onset of QED effects should cause breakdown of rel- ativistic similarity. Here the validity of the ZVP model is tested across this parameter space for the first time.

\subsubsection{Reference units}
To great convenience, Smilei operates in normalised units. This normalisation is not chosen \textit{a priori}, instead results can be scaled by an arbitrary reference angular frequency. This is extremely useful when working with boosted frames of reference. As this thesis focuses on the interaction of a laser pulse with plasma, the laser pulse angular frequency, $\omega_\mathrm{L}$ is set as the frequency of reference. A list of the most common normalisations are given in table \ref{tab:intro-normalisations}.

\begin{table}
\begin{center}
\begin{tabular}{ccc}
	 \hline \hline
	Units of & SI units & Normalisation \\
	\hline
	velocity & \unit{m.s^{-1}} & $c$ \\
	charge & C & $e$ \\
	mass & kg & $m_\mathrm{e}$ \\
	momentum & \unit{kg.m.s^{-1}} & $m_\mathrm{e}c$ \\
	energy/temperature & J & $m_\mathrm{e}c^2$ \\
	time & s & $\omega^{-1}_\mathrm{L}$ \\
	length & m & $c/\omega_\mathrm{L}$ \\
	number density & \unit{m^{-3}} & $n_\mathrm{c}$ \\
	electric field & \unit{V.m^{-1}} & $m_\mathrm{e}c\omega_\mathrm{L}/e$ \\
	\hline \hline
\end{tabular}
	\caption{\label{tab:intro-normalisations} Smilei normalisations for common quantities with the laser angular frequency $\omega_\mathrm{L}$ set at the reference angular frequency.}
\end{center}
\end{table}



\subsubsection{General simulation parameters}\label{sec:intro-general_simulation_paramers}
\textbf{Boundary conditions}
"Silver-M$\ddot{\mathrm{u}}$ller" boundary conditions for the simulation box edges \textbf{cite - H Barucq Asymptomatic analysis 1997}. These are able to absorp and inject electromagnetic waves and particles. Note that there can be non-physical reflection of electromagnetic waves at such boundaries leading to error.

\textbf{Shape function} The quasi-particle shape function $S(\mathbf{x})$ describes how to project charge onto the grid. It is symmetric in all dimensions with respect to $\mathbf{x}$ and extends over $n$ cells of width $\Delta x$ in each direction where $n$ is the interpolation order. It can be written as a product across $D$ dimensions,
\begin{equation}
	S(\mathbf{x}) = \Pi^D_{\mu = 1}s^{(n)}(x^\mu).
\end{equation}
Smilei implements orders 2, 3 and 4, the explicit shape functions are
\begin{subequations}
	\begin{align}
	s^2 (n) &= \begin{cases}
		\frac{1}{\Delta x}\left(1-\left|\frac{x}{\Delta x}\right| \right)  & \text{if } |x| \le \Delta x, \\
		0  & \text{otherwise,}
	\end{cases} \\
	s^3(n) &= \begin{cases}
		\frac{3}{4\Delta x}\left(1-\frac{4}{3}\left(\frac{x}{\Delta x}\right)^2 \right)  & \text{if } |x| \le \frac{1}{2}\Delta x, \\
		\frac{9}{8\Delta x}\left(1-\frac{2}{3}\left|\frac{x}{\Delta x}\right| \right)^2  & \text{if } \frac{1}{2}\Delta x <|x| \le \frac{3}{2} \Delta x, \\
		0  & \text{otherwise,}
	\end{cases}  \\
		s^4(n) &= \begin{cases}
		\frac{2}{3 \Delta x}\left( 1-\frac{3}{2}\left(\frac{x}{\Delta x}\right)^2 + \frac{3}{4}\left| \frac{x}{\Delta x}\right| ^3 \right)  & \text{if } |x| \le \Delta x, \\
		\frac{4}{3 \Delta x}\left(1-\frac{1}{2}\left|\frac{x}{\Delta x}\right| ^3 \right)  & \text{if } \Delta x <|x| \le 2\Delta x, \\
		0  & \text{otherwise.}
	\end{cases} 
	\end{align}
\end{subequations}

\subsubsection{Parallelisation}
Modern \ac{HPC} systems are poised to enter the exascale regime ($> 10^{18}$ Floating Point Operations Per Second). With limited improvements in microprocessor technologies, such power is achieved through massive parallelisation across processing units. To enable the study of the dynamics of up to billions of macroparticles, PIC codes test the limits of current supercomputing architectures. 

\subsubsection{Supercomputing resources}\label{sec:intro-archer}
ARCHER2, the UK's national supercomputer came online in November 2021, with it delivering over ten times the reseources of its predecessor (ARCHER) \cite{ARCHER2}. An HPE Cray EX supercomputing system with a peak performance estimated at \qty{28}{Pflops.s^{-1}} across 5860 nodes each with dual AMD EPYCTM 7742 64-core processor for a total of 750,080 cores, ARCHER2 was able to supply the resources required to run the costly PIC simulations for this research. The substantially cheaper HYADES simulations were performed using the Rutherford Appleton Laboratory's SCARF \ac{HPC} cluster \cite{SCARFOverview}.

\subsubsection{Parallelisation in practice}
In the following discussion, where differences in language occur, objects are given as their ARCHER2 (Smilei) names. The Smilei simulation box consists of a grid of cells as in figure \ref{fig:introsmileiparallelisation}.
% TODO: \usepackage{graphicx} required
\begin{figure}
	\centering
	\includegraphics[width=1\linewidth]{figures/intro/intro_smilei_parallelisation}
	\caption[Smilei simulation box decomposition into cells, patches and MPI patch collections.]{Smilei simulation box decomposition into cells, patches and MPI patch collections. Cells are grouped into patches, patches are grouped into MPI patch collections. MPI patches are assigned contiguously along the Hilbert curve.}
	\label{fig:introsmileiparallelisation}
\end{figure}
The box is decomposed into patches consisting of many cells. Patches are arranged into MPI patch collections assigned contiguously along a Hilbert curve.

Archer consists of many CPUs (cores) that can each perform computational tasks. CPUs are grouped together into nodes. Memory is shared within a node such that all CPUs (cores) in a node can operate on the same data. When optimised, ARCHER2’s memory in each node is split into 8 sockets. These 8 sockets each perform a task (MPI process). Each task (MPI process) has 16 CPUs (cores) assigned that each perform a thread. A thread is a sequence of instructions from the program.

Each task (MPI process) handles one MPI patch collection. Threads work through patches. Figure \ref{fig:introsmileiparallelisationcomplex} represents this division of labour.
% TODO: \usepackage{graphicx} required
\begin{figure}
	\centering
	\includegraphics[width=1\linewidth]{figures/intro/intro_smilei_parallelisation_complex}
	\caption[Representation of the interaction of the ARCHER2 hardware and software components when running Smilei.]{Representation of the interaction of the ARCHER2 hardware and software components when running Smilei.}
	\label{fig:introsmileiparallelisationcomplex}
\end{figure}
Threads do not need to wait for other threads in their process to tackle new patches in their MPI patch collection. This is a form of local dynamic load balancing. If an MPI patch collection is overloaded, a patch is offloaded to a contiguous MPI patch collection.

There are several considerations for simulation optimisation, namely,
\begin{itemize}
	\item To apply the Hilbert curve, it is required that the number of patches in each dimension is a power of 2;
	\item The less cells in a patch, the more efficient the load balancing, however, the cost of synchronisation between patches increases.;
	\item Smaller patches are preferable when there are small regions with large numbers of particles, as in laser-solid surface interactions, however, the minimum patch size is dependent on the shape function of the macroparticles;
	\item Tasks (MPI processes) should be assigned more patches than threads.
\end{itemize}

